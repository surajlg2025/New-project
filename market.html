<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sahifasal · intelligent market hub</title>
 
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,300;14..32,400;14..32,600;14..32,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --green-deep: #0a5c40;
      --green-primary: #0e7b5c;
      --green-light: #d1fae5;
      --teal-soft: #b8e2de;
      --cream-bg: #f4fcf7;
      --card-glass: rgba(255, 255, 255, 0.7);
      --glass-border: 1px solid rgba(255, 255, 255, 0.5);
      --shadow-sm: 0 8px 20px -6px rgba(20, 70, 30, 0.15);
      --shadow-hover: 0 20px 30px -8px rgba(7, 80, 40, 0.25);
      --text-dark: #0c4a2e;
      --text-soft: #2d4f3c;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(165deg, #e6f7ec 0%, #b8e2de 100%);
      color: var(--text-dark);
      min-height: 100vh;
      line-height: 1.5;
      position: relative;
      overflow-x: hidden;
    }

    
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" opacity="0.03"><path d="M30,70 Q45,45 70,55 Q58,80 30,70" fill="%231b6e3a" transform="rotate(15 50 60)"/><path d="M130,40 Q150,20 170,35 Q155,60 130,40" fill="%231b6e3a" transform="rotate(-5 150 40)"/><path d="M80,150 Q100,125 125,140 Q110,170 80,150" fill="%231b6e3a" transform="rotate(25 100 140)"/><path d="M160,150 Q180,135 190,165 Q165,175 160,150" fill="%231b6e3a" transform="rotate(-10 175 155)"/></svg>');
      background-repeat: repeat;
      background-size: 220px 220px;
      pointer-events: none;
      animation: drift 80s linear infinite;
      z-index: 0;
    }

    @keyframes drift {
      from { background-position: 0 0; }
      to { background-position: 300px 300px; }
    }

    
    .topbar {
      position: fixed;
      top: 0;
      width: 100%;
      height: 70px;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      display: flex;
      align-items: center;
      padding: 0 28px;
      box-shadow: 0 6px 18px rgba(30, 70, 30, 0.08);
      z-index: 1000;
      border-bottom: 1px solid rgba(255, 255, 255, 0.6);
    }

    .left {
      display: flex;
      align-items: center;
      gap: 18px;
    }

    .menu-btn {
      font-size: 28px;
      cursor: pointer;
      color: var(--green-deep);
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.6);
      transition: 0.2s;
    }

    .menu-btn:hover {
      background: white;
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(0, 70, 30, 0.2);
    }

    .logo-box img {
      height: 90px;
      border-radius: 50%;
      object-fit: cover;
      padding: 4px;
    }

    .app-name {
      font-size: 1.4rem;
      font-weight: 700;
      color: #116845;
      letter-spacing: -0.01em;
    }

    
    .sidebar {
      position: fixed;
      top: 70px;
      left: -280px;
      width: 260px;
      height: calc(100% - 70px);
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      padding: 30px 16px;
      transition: left 0.35s ease;
      box-shadow: 8px 0 30px -12px #1b4d33;
      z-index: 999;
      border-right: 1px solid rgba(255, 255, 255, 0.8);
    }

    .sidebar.active {
      left: 0;
    }

    .sidebar a {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 20px;
      color: #0b543c;
      text-decoration: none;
      font-weight: 500;
      border-radius: 60px;
      margin: 6px 0;
      transition: 0.2s;
      border: 1px solid transparent;
    }

    .sidebar a:hover {
      background: rgba(30, 130, 80, 0.12);
      border-color: rgba(80, 180, 120, 0.3);
      transform: translateX(8px);
      color: #046a43;
    }

    
    .content {
      margin-top: 90px;
      padding: 35px 7%;
      transition: margin-left 0.35s;
      position: relative;
      z-index: 10;
    }

    .header h1 {
      font-size: 2.4rem;
      font-weight: 700;
      background: linear-gradient(130deg, #0f5e44, #118765);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 8px;
    }

    .header p {
      color: #1e5e48;
      font-size: 1.2rem;
      background: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(4px);
      width: fit-content;
      padding: 8px 28px 8px 20px;
      border-radius: 40px;
      border-left: 6px solid #2d9c70;
      margin-bottom: 30px;
    }

    
    .market-toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 25px;
      background: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(8px);
      padding: 15px 25px;
      border-radius: 50px;
      border: 1px solid rgba(255,255,255,0.6);
      box-shadow: var(--shadow-sm);
    }

    .search-box {
      flex: 2;
      min-width: 240px;
      display: flex;
      align-items: center;
      background: white;
      border-radius: 40px;
      padding: 5px 15px;
      border: 1px solid rgba(0,100,50,0.2);
      transition: box-shadow 0.2s;
    }

    .search-box:focus-within {
      box-shadow: 0 0 0 3px rgba(14, 123, 92, 0.2);
      border-color: var(--green-primary);
    }

    .search-box i {
      color: #0e7b5c;
      font-size: 1.2rem;
      margin-right: 10px;
    }

    .search-box input {
      border: none;
      background: transparent;
      padding: 12px 0;
      width: 100%;
      outline: none;
      font-size: 1rem;
    }

    .summary-stats {
      display: flex;
      gap: 25px;
      flex-wrap: wrap;
    }

    .stat-item {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255,255,255,0.6);
      padding: 8px 20px;
      border-radius: 40px;
      font-weight: 600;
      box-shadow: 0 4px 8px rgba(0,30,0,0.05);
    }

    .stat-item i {
      color: #0e7b5c;
      font-size: 1.3rem;
    }

    
    .form-card {
      background: var(--card-glass);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border-radius: 32px;
      padding: 30px 28px;
      box-shadow: var(--shadow-sm);
      border: var(--glass-border);
      max-width: 620px;
      margin-bottom: 40px;
      transition: 0.2s;
    }

    .form-card:hover {
      box-shadow: var(--shadow-hover);
    }

    .form-row {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      align-items: flex-end;
    }

    .form-group {
      flex: 1 1 180px;
      margin-bottom: 10px;
    }

    .form-group label {
      font-size: 0.9rem;
      font-weight: 600;
      color: #0a6846;
      display: block;
      margin-bottom: 5px;
    }

    .form-group select {
      width: 100%;
      padding: 12px 16px;
      border-radius: 40px;
      border: 1px solid rgba(0, 100, 50, 0.2);
      background: rgba(255, 255, 255, 0.8);
      font-size: 0.95rem;
      color: #1c4b34;
      outline: none;
      transition: 0.2s;
      cursor: pointer;
    }

    .form-group select:focus {
      border-color: #0e7b5c;
      box-shadow: 0 0 0 3px rgba(14, 123, 92, 0.2);
      background: white;
    }

    .btn-estimate {
      flex: 0 0 auto;
      padding: 12px 28px;
      border: none;
      border-radius: 40px;
      background: linear-gradient(135deg, #0f7a5a, #0a5f43);
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: 0.25s;
      box-shadow: 0 8px 18px rgba(10, 90, 50, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.4);
      font-size: 1rem;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-estimate:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 25px -8px #0a5f43;
      background: linear-gradient(135deg, #159d72, #0e784f);
    }

   
    .market-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 28px;
      margin: 30px 0 20px;
    }

    .card {
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(14px);
      border-radius: 32px;
      padding: 24px 22px;
      box-shadow: var(--shadow-sm);
      border: var(--glass-border);
      transition: 0.25s;
      position: relative;
      overflow: hidden;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .card:hover {
      transform: translateY(-8px);
      box-shadow: var(--shadow-hover);
      background: rgba(255, 255, 255, 0.85);
    }

    .card::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 6px;
      background: linear-gradient(90deg, #22c55e, #0e7b5c);
      border-radius: 32px 32px 0 0;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .crop {
      font-size: 1.6rem;
      font-weight: 700;
      color: #0e6e4b;
    }

    .favorite {
      color: #cbd5e1;
      cursor: pointer;
      transition: 0.2s;
      font-size: 1.5rem;
    }

    .favorite.active {
      color: #fbbf24;
    }

    .favorite:hover {
      transform: scale(1.1);
    }

    .price-section {
      display: flex;
      align-items: baseline;
      gap: 10px;
      flex-wrap: wrap;
      margin: 12px 0 8px;
    }

    .price {
      font-size: 2.2rem;
      font-weight: 700;
      color: #1b4d33;
    }

    .trend-indicator {
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 1rem;
      font-weight: 600;
      padding: 4px 12px;
      border-radius: 30px;
      background: rgba(255,255,255,0.5);
    }

    .trend-up { color: #16a34a; }
    .trend-down { color: #dc2626; }

    .market-location {
      font-size: 1rem;
      color: #2e6a4f;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .bar {
      height: 8px;
      background: rgba(0, 50, 20, 0.1);
      border-radius: 20px;
      margin: 15px 0 10px;
      overflow: hidden;
    }

    .fill {
      height: 100%;
      background: linear-gradient(90deg, #22c55e, #16a34a);
      border-radius: 20px;
      width: 0%;
      transition: width 0.8s ease;
    }

    
    .insight {
      margin-top: 45px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 28px;
    }

    .panel {
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(14px);
      border-radius: 32px;
      padding: 28px;
      box-shadow: var(--shadow-sm);
      border: var(--glass-border);
      transition: 0.2s;
    }

    .panel:hover {
      box-shadow: var(--shadow-hover);
    }

    .panel h2 {
      font-size: 1.8rem;
      color: #0e6e4b;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .panel p {
      color: #1e5e48;
      font-size: 1.1rem;
    }

    .footer {
      margin-top: 70px;
      background: rgba(10, 35, 25, 0.85);
      backdrop-filter: blur(8px);
      border-radius: 60px 60px 20px 20px;
      text-align: center;
      padding: 22px 15px;
      color: #ebf9f0;
      font-weight: 500;
      font-size: 1.1rem;
      border: 1px solid rgba(210, 245, 220, 0.3);
    }

    
    @media (max-width: 900px) {
      .insight {
        grid-template-columns: 1fr;
      }
      .market-toolbar {
        flex-direction: column;
        align-items: stretch;
        border-radius: 40px;
        padding: 20px;
      }
      .summary-stats {
        justify-content: space-around;
      }
      .form-card {
        max-width: 100%;
      }
      .form-row {
        flex-direction: column;
        align-items: stretch;
      }
      .btn-estimate {
        width: 100%;
        justify-content: center;
      }
    }

    @media (max-width: 700px) {
      .content {
        padding: 25px 5%;
      }
      .header h1 {
        font-size: 2rem;
      }
      .header p {
        font-size: 1rem;
      }
      .topbar {
        padding: 0 18px;
      }
      .app-name {
        font-size: 1.2rem;
      }
      .menu-btn {
        width: 40px;
        height: 40px;
        font-size: 24px;
      }
      .logo-box img {
        height: 75px;
      }
    }

    @media (max-width: 500px) {
      .stat-item {
        padding: 6px 15px;
        font-size: 0.9rem;
      }
      .stat-item i {
        font-size: 1.1rem;
      }
      .card {
        padding: 20px 16px;
      }
      .crop {
        font-size: 1.4rem;
      }
      .price {
        font-size: 1.8rem;
      }
      .panel h2 {
        font-size: 1.5rem;
      }
      .panel p {
        font-size: 1rem;
      }
      .footer {
        font-size: 0.95rem;
        padding: 18px 12px;
      }
    }

    @media (max-width: 380px) {
      .topbar {
        flex-wrap: wrap;
        height: auto;
        padding: 10px 15px;
        gap: 10px;
      }
      .left {
        width: 100%;
        justify-content: center;
      }
      .sidebar {
        top: 110px;
        height: calc(100% - 110px);
      }
      .content {
        margin-top: 120px;
      }
    }

    a:focus-visible, button:focus-visible, input:focus-visible, select:focus-visible {
      outline: 3px solid #4b9e5a;
      outline-offset: 3px;
    }
  </style>
</head>
<body>


<div class="topbar">
  <div class="left">
    <div class="menu-btn" onclick="toggleSidebar()">☰</div>
    <div class="logo-box">
      <img src="final logo.png" alt="logo" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'44\' height=\'44\' viewBox=\'0 0 100 100\'%3E%3Ccircle cx=\'50\' cy=\'50\' r=\'45\' fill=\'%230e7b5c\'/%3E%3Ctext x=\'50\' y=\'70\' font-size=\'50\' text-anchor=\'middle\' fill=\'white\' font-family=\'Arial\'%3ES%3C/text%3E%3C/svg%3E'">
    </div>
    <div class="app-name">Sahifasal</div>
  </div>
</div>


<div class="sidebar" id="sidebar">
  <a href="dashboard.html"><i class="fas fa-home"></i> Dashboard</a>
  <a href="climate.html"><i class="fas fa-cloud-sun"></i> Climate</a>
  <a href="market.html"><i class="fas fa-chart-line"></i> Market</a>
  <a href="risk.html"><i class="fas fa-exclamation-triangle"></i> Risk</a>
  <a href="planner.html"><i class="fas fa-calendar-alt"></i> Planner</a>
  <a href="profit.html"><i class="fas fa-coins"></i> Profit</a>
  <a href="govt.html"><i class="fas fa-gavel"></i> Govt Schemes</a>
  <a href="profile.html"><i class="fas fa-user"></i> Profile</a>
  <a href="index.html"><i class="fas fa-sign-out-alt"></i> Logout</a>
</div>


<div class="content">
  <div class="header">
    <h1><i class="fas fa-chart-line" style="color:#0e7b5c;"></i> Live Market Pulse</h1>
    <p>real‑time prices · trends · intelligent filters</p>
  </div>

  
  <div class="form-card">
    <div class="form-row">
      <div class="form-group">
        <label>State</label>
        <select id="state">
          <option>Madhya Pradesh</option>
          <option>Maharashtra</option>
          <option>Rajasthan</option>
          <option>Gujarat</option>
        </select>
      </div>
      <div class="form-group">
        <label>Commodity</label>
        <select id="commodity">
          <option>Potato</option>
          <option>Soyabean</option>
          <option>Wheat</option>
          <option>Apple</option>
        </select>
      </div>
      <button class="btn-estimate" onclick="fetchMarketData()"><i class="fas fa-search"></i> Fetch prices</button>
    </div>
  </div>

  
  <div class="market-toolbar">
    <div class="search-box">
      <i class="fas fa-filter"></i>
      <input type="text" id="searchInput" placeholder="Filter by market name..." onkeyup="filterCards()">
    </div>
    <div class="summary-stats" id="summaryStats">
      <div class="stat-item"><i class="fas fa-store"></i> <span id="marketCount">0</span> markets</div>
      <div class="stat-item"><i class="fas fa-chart-line"></i> avg ₹<span id="avgPrice">0</span></div>
    </div>
  </div>

  
  <div id="marketData" class="market-grid"></div>


  <div class="insight">
    <div class="panel">
      <h2><i class="fas fa-globe-asia"></i> Global Opportunity</h2>
      <p>Soybean export demand surging. Premium prices for organic produce. Consider forward contracts.</p>
    </div>
    <div class="panel">
      <h2><i class="fas fa-microchip"></i> AI Insight</h2>
      <p>Maize prices expected to rise 8% next month. Recommended selling window: next 30 days.</p>
    </div>
  </div>

  <div class="footer">
    © 2026 Sahifasal — smart farming intelligence
  </div>
</div>

<script>
  
  function toggleSidebar() {
    document.getElementById('sidebar').classList.toggle('active');
  }
  document.addEventListener('click', function(e) {
    const sidebar = document.getElementById('sidebar');
    const btn = document.querySelector('.menu-btn');
    if (!sidebar.contains(e.target) && !btn.contains(e.target) && sidebar.classList.contains('active')) {
      sidebar.classList.remove('active');
    }
  });

  
  let allMarkets = []; 

  
  async function fetchMarketData() {
    const state = document.getElementById('state').value;
    const commodity = document.getElementById('commodity').value;
    const url = `https://api.data.gov.in/resource/9ef84268-d588-465a-a308-a864a43d0070?api-key=579b464db66ec23bdd000001e367c7882834471d76c5d2beb0b65d56&format=json&filters[state]=${state}&filters[commodity]=${commodity}`;
    try {
      const response = await fetch(url);
      const data = await response.json();
      if (!data.records || data.records.length === 0) {
        document.getElementById('marketData').innerHTML = '<p style="grid-column:1/-1; text-align:center;">No market data found.</p>';
        allMarkets = [];
        updateSummary();
        return;
      }
      
      allMarkets = data.records.map(record => ({
        ...record,
        trend: Math.random() > 0.5 ? 'up' : 'down',
        changePercent: (Math.random() * 5 + 1).toFixed(1),
        favorite: false
      }));
      renderMarketCards(allMarkets);
    } catch (err) {
      console.error(err);
      alert('Failed to load market data. Using sample data.');
      
      allMarkets = generateSampleMarkets(state, commodity);
      renderMarketCards(allMarkets);
    }
  }

  
  function generateSampleMarkets(state, commodity) {
    const markets = ['Central Market', 'Grain Mandi', 'Krishi Bazaar', 'APMC Yard', 'Farmer Market'];
    return markets.map((name, idx) => ({
      commodity: commodity,
      market: name,
      district: state.split(' ')[0],
      state: state,
      modal_price: (1500 + idx * 300 + Math.floor(Math.random() * 500)).toString(),
      trend: Math.random() > 0.5 ? 'up' : 'down',
      changePercent: (Math.random() * 8 + 1).toFixed(1),
      favorite: false
    }));
  }

 
  function renderMarketCards(markets) {
    const container = document.getElementById('marketData');
    if (!markets.length) {
      container.innerHTML = '<p style="grid-column:1/-1; text-align:center;">No matching markets.</p>';
      updateSummary(markets);
      return;
    }

    
    const prices = markets.map(m => parseInt(m.modal_price) || 0);
    const maxPrice = Math.max(...prices, 1);

    let html = '';
    markets.forEach((m, index) => {
      const price = parseInt(m.modal_price) || 0;
      const barWidth = (price / maxPrice) * 100;
      const trendIcon = m.trend === 'up' ? 'fa-arrow-up' : 'fa-arrow-down';
      const trendClass = m.trend === 'up' ? 'trend-up' : 'trend-down';
      const favClass = m.favorite ? 'active' : '';

      html += `
        <div class="card" data-market="${m.market.toLowerCase()}" data-index="${index}">
          <div class="card-header">
            <span class="crop">${m.commodity}</span>
            <span class="favorite ${favClass}" onclick="toggleFavorite(${index})"><i class="fas fa-star"></i></span>
          </div>
          <div class="price-section">
            <span class="price">₹ ${m.modal_price}</span>
            <span class="trend-indicator ${trendClass}">
              <i class="fas ${trendIcon}"></i> ${m.changePercent}%
            </span>
          </div>
          <div class="market-location">
            <i class="fas fa-map-pin"></i> ${m.market}, ${m.district}
          </div>
          <div class="bar">
            <div class="fill" style="width: ${barWidth}%;"></div>
          </div>
          <div style="font-size:0.85rem; color:#4b7b63;"><i class="far fa-clock"></i> updated just now</div>
        </div>
      `;
    });
    container.innerHTML = html;
    updateSummary(markets);
  }

  
  function filterCards() {
    const term = document.getElementById('searchInput').value.toLowerCase();
    if (!allMarkets.length) return;
    const filtered = allMarkets.filter(m => m.market.toLowerCase().includes(term));
    renderMarketCards(filtered);
  }

  
  function toggleFavorite(index) {
    const marketItem = allMarkets[index];
    if (marketItem) {
      marketItem.favorite = !marketItem.favorite;
      
      filterCards();
    }
  }


  window.toggleFavorite = toggleFavorite;

  
  function updateSummary(markets = allMarkets) {
    const count = markets.length;
    const avg = markets.reduce((acc, m) => acc + (parseInt(m.modal_price) || 0), 0) / (count || 1);
    document.getElementById('marketCount').innerText = count;
    document.getElementById('avgPrice').innerText = Math.round(avg);
  }

  
  window.onload = function() {
    fetchMarketData();
  };

  
  window.fetchMarketData = fetchMarketData;
  window.filterCards = filterCards; 
</script>


</body>
</html>